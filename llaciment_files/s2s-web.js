!function(){var t={135:function(t,e,n){t.exports=n(248)},248:function(t){var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===v){if("throw"===i)throw o;return x()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?v:d,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=v,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f="suspendedStart",d="suspendedYield",h="executing",v="completed",m={};function p(){}function g(){}function y(){}var b={};b[o]=function(){return this};var k=Object.getPrototypeOf,S=k&&k(k(O([])));S&&S!==n&&r.call(S,o)&&(b=S);var w=y.prototype=p.prototype=Object.create(b);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function n(i,o,a,s){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,s)}))}s(u.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function E(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:x}}function x(){return{value:e,done:!0}}return g.prototype=w.constructor=y,y.constructor=g,g.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},P(I.prototype),I.prototype[a]=function(){return this},t.AsyncIterator=I,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new I(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(w),u(w,s,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=O,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var t=n(135),e=n.n(t);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function t(){r(this,t),this.forceImprTime=3,this.dnt=!0,this.segment={maxSegments:400,maxSegmentStateItems:86400,minSegmentDuration:1e3},this.enabled=!0,this.projectVersion="1.0",this.configVersion=1,this.sdkVersion="2.2.2",this.tech="s2s-w",this.projectName="es1",this.trackingUrl="https://es1-s2s.sensic.net",this.streamCustom=["c1","c2","programmname","streamlength","channelname","airtime"],this.contentCustom=["c1","c2","c3","c4","c5","c6","c7","c8","c9","c10"],this.heartbeat={enabled:!0,interval:[1,2,3,5,10,20],maximum:0}};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var u={none:0,error:1,warn:2,info:3,log:4,debug:5},c=["none","debug","log","info","warn","error"],l=function(){function t(){r(this,t)}return s(t,null,[{key:"debug",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.output(e,"debug",n.coloring,n.extraObj)}},{key:"log",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.output(e,"log",n.coloring,n.extraObj)}},{key:"info",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.output(e,"info",n.coloring,n.extraObj)}},{key:"warn",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.output(e,"warn",n.coloring,n.extraObj)}},{key:"error",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.output(e,"error",n.coloring,n.extraObj)}},{key:"output",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!(u[n]>u[t.logLevel])){if(t.url&&XMLHttpRequest){var a=new XMLHttpRequest,s=t.url+"?"+n+"="+encodeURIComponent(e+(i?"\n"+JSON.stringify(i):""))+"&src=S2S";a.open("GET",s,!0),a.send()}if("undefined"!=typeof console){var c=(r?"%c ":"")+e+(r?" %c":""),l=console;"function"==typeof l[n]?"fcall"===r?i?l[n]("GFK: "+c,"background: #060; color: #fff","","object"===o(i)&&Array.from?Array.from(i):i):l[n]("GFK: "+c,"background: #060; color: #fff",""):"request"===r?l[n]("GFK: "+c,"background: #059; color: #fff","",i):l[n]("GFK: "+c):l.error("GFK: "+c)}}}},{key:"formatDuration",value:function(t){var e=t%1e3,n=(t=(t-e)/1e3)%60,r=(t=(t-n)/60)%60,i=(t-r)/60;return(i?i+":":"")+("0"+r).slice(-2)+":"+("0"+n).slice(-2)+"."+("00"+e).slice(-3)}},{key:"readFromTagConf",value:function(){this.readFromConf(window.gfkS2sConf)}},{key:"readFromConnectorConf",value:function(){this.readFromConf(window.gfkConnectorConf)}},{key:"readFromLocalStorage",value:function(){try{if(window.localStorage){var e=window.localStorage.getItem("sensic-logLevel");f(e)&&(t.logLevel=e)}}catch(t){console.warn("Couldn't read log settings from local storage:",t)}}},{key:"readFromConf",value:function(e){f(null==e?void 0:e.logLevel)&&(t.logLevel=e.logLevel),(null==e?void 0:e.logUrl)&&(t.url=e.logUrl)}}]),t}();function f(t){return c.includes(t)}l.logLevel="none",l.url=null;var d=function(){function t(e){r(this,t),this.appType=e.hasOwnProperty("type")?e.type:"WEB";var n=t.getParticularDeviceType(),i=e.hasOwnProperty("device")?e.device:"UNKNOWN";this.deviceType="UNKNOWN"===n?i:n}return s(t,[{key:"getOrigin",value:function(){return t.isWebContext()?window.location.protocol+"//"+window.location.hostname:""}},{key:"getLanguage",value:function(){return t.isWebContext()?window.navigator.language||window.navigator.userLanguage:""}},{key:"getProjectStatus",value:function(){return t.config.enabled}},{key:"getContentCustomParameter",value:function(){return t.config.contentCustom}},{key:"getStreamCustomParameter",value:function(){return t.config.streamCustom}},{key:"getVersion",value:function(){return t.config.projectVersion+"/"+t.config.sdkVersion+"/"+t.config.configVersion}},{key:"getTechnology",value:function(){return t.config.tech}},{key:"getProjectName",value:function(){return t.config.projectName}},{key:"getTrackingUrl",value:function(){return t.config.trackingUrl}},{key:"getHeartbeatSettings",value:function(){return t.config.heartbeat}},{key:"getSegmentSettings",value:function(){return t.config.segment}},{key:"getAppType",value:function(){return this.appType}},{key:"getDeviceType",value:function(){if("undefined"!=typeof window&&(window.cast&&"CONNECTED"===window.cast.framework.CastContext.getInstance().getCastState()))return"chromecast";return this.deviceType}}],[{key:"determineDeviceType",value:function(t,e){var n="";return e.match(/Linux/i)&&t.match(/(WEBOS)/i)&&(n="Smart-TV"),n}},{key:"determineOs",value:function(t,e){var n="";return e.match(/Linux /i)&&t.match(/WEBOS/i)&&(n="WebOS"),n}},{key:"getPlatform",value:function(){return t.isWebContext()?window.navigator.platform:""}},{key:"getOperatingSystem",value:function(){var e=t.getUserAgent(),n=t.getPlatform();return t.determineOs(e,n)}},{key:"getParticularDeviceType",value:function(){var e=t.getUserAgent(),n=t.getPlatform();return t.determineDeviceType(e,n)}},{key:"getUserAgent",value:function(){return t.isWebContext()?window.navigator.userAgent:""}},{key:"getTimeOffset",value:function(){return t.timeOffset}},{key:"getTimeWithOffset",value:function(){return t.getUTCTimeStamp()+t.getTimeOffset()}},{key:"setTimeOffset",value:function(){"idle"!==t.dateStatus&&"canceled"!==t.dateStatus||(t.dateStatus="waiting",t.getServerDate())}},{key:"isDntEnabled",value:function(){return t.config.dnt}},{key:"setConfig",value:function(e){t.isHttp()&&["trackingUrl"].forEach((function(t){window.s2sSdkConfig[t]=window.s2sSdkConfig[t].replace(/^https:/,"http:")})),t.config=e}},{key:"init",value:function(e,n){var r;t.suiapiV2=n,t.tagConf=e,"undefined"!=typeof document&&(t.suiapiV2.init(t.tagConf.optin),(null===(r=window.gfkS2s)||void 0===r?void 0:r.scb)&&"function"==typeof window.gfkS2s.scb&&window.gfkS2s.scb(t.suiapiV2.instanceID))}},{key:"getInstanceID",value:function(){return t.suiapiV2.instanceID}},{key:"getServerDate",value:function(){window.top.addEventListener("message",(function(e){e.data.relayRequestServerDate&&"finished"!==t.dateStatus&&"canceled"!==t.dateStatus&&(t.dateStatus="finished",t.setCalculatedOffset(e.data.relayRequestServerDate))})),setTimeout((function(){"finished"!==t.dateStatus&&(t.dateStatus="canceled",l.output("Request Timeout!","warn"))}),3e3)}},{key:"setCalculatedOffset",value:function(e){var n=t.getUTCTimeStamp(),r=Date.parse(e);t.timeOffset=isNaN(r)?0:r-n,0!==t.timeOffset&&l.output("Time offset = "+t.timeOffset+" milliseconds","info")}},{key:"getUTCTimeStamp",value:function(){return(new Date).getTime()}},{key:"isWebContext",value:function(){return"undefined"!=typeof window}},{key:"isHttp",value:function(){if("undefined"!=typeof window){if(window.document.currentScript){var t=window.document.currentScript;if(t.src)return t.src.match(/^http:/)}for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++)if(e[n]&&e[n].src.match(/\/s2s-web.js$/))return null!==e[n].src.match(/^http:/);if("http:"===window.location.protocol)return!0}return!1}}]),t}();d.dateStatus="idle",d.timeOffset=0;var h=function(){function t(){r(this,t)}return s(t,null,[{key:"validateTagConfig",value:function(t){var e="gfkS2sConf = {...}";if(!this.isStringAndNotEmpty(t.media,"mediaId",e))throw new Error;if(!this.isStringAndNotEmpty(t.url,"url",e))throw new Error;if(!this.isStringAndNotEmpty(t.type,"type",e))throw new Error;switch(t.type){case"APP":if(!this.isStringAndNotEmpty(t.device,"device",e))throw this.errorLog(e,"device","","Missing or empty property","error"),new Error;if(!t.hasOwnProperty("ai"))throw this.errorLog(e,"ai","","Missing property","error"),new Error;-1===["SMARTPHONE","TABLET","TV","DESKTOP"].indexOf(t.device)&&(this.errorLog(e,"device",t.device,"Unknown device type, see documentation","warn"),t.device="UNKNOWN");break;case"WEB":case"TV":break;default:throw this.errorLog(e,"type",t.type,"Unknown app type, see documentation (configuration)","error"),new Error("Unknown type")}}},{key:"isStringAndNotEmpty",value:function(t,e,n,r){var i="string"==typeof t&&t.length>0;return!1===i&&this.errorLog(n,e,t,"is not a string",r),i}},{key:"isCorrectStreamOffset",value:function(t,e,n,r){var i="number"==typeof t&&t>=0;return i||this.errorLog(n,e,t,"is not a positive number!",r),i}},{key:"isCorrectStreamStart",value:function(t,e,n,r){var i=Date.parse(t);return!isNaN(i)||0===t.length||(this.errorLog(n,e,t,"must be a valid date string with timezone offset (YYYY-MM-DDTHH:ii:ss TZ +OFFSET)!",r),!1)}},{key:"areParameterValid",value:function(t){for(var e in t)if(t.hasOwnProperty(e)&&!1===t[e])return l.output('Input param "'.concat(e,"\" is not valid, request couldn't be sent!"),"warn"),!1;return!0}},{key:"isPlayOptionsValid",value:function(t,e,n,r){var i=!0;if("object"!==o(t))this.errorLog(n,e,"(valueType="+o(t)+")","is invalid object!","warn"),i=!1;else{void 0===t.screen||"string"==typeof t.screen||(this.errorLog(n,e+".screen","(valueType="+o(t.screen)+")","is invalid object!","warn"),i=!1),void 0!==t.volume&&"string"!=typeof t.volume&&(i=!1),"string"==typeof t.speed&&isNaN(parseFloat(t.speed))&&(i=!1);var a=void 0===t.position;r&&(a=a||"number"==typeof t.position),a||(this.errorLog(n,e+".position","(valueType="+o(t.position)+")","is invalid object!","warn"),i=!1)}return i}},{key:"areCustomParametersValid",value:function(t,e,n){var r="object"===o(t);return!1===r&&this.errorLog(n,e,"(valueType="+o(t)+")","is invalid object!","warn"),r}},{key:"checkArgCount",value:function(e,n,r){if(!t.isArgumentsLengthValid(e,n,r))throw new Error(r+" cannot be executed!")}},{key:"isArgumentsLengthValid",value:function(t,e,n,r){return!1!=(t===e)||(this.errorLog(n,"Input parameter number",t.toString(),"; Invalid number of arguments, given: "+t+", expected: "+e+"!",r),!1)}},{key:"errorLog",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error";l.output("Origin="+t+"; Parameter="+e+"; Value="+n+"; "+r,i)}}]),t}();function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function p(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=function(){function t(e,n){r(this,t),this.sMediaId=e,this.sInstance=n}return s(t,[{key:"mediaId",get:function(){return this.sMediaId}},{key:"instance",get:function(){return this.sInstance}}]),t}();function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var k=function(t){m(n,t);var e=b(n);function n(t,i,o,a,s,u,c,l){var f;return r(this,n),(f=e.call(this,t,l)).iStreamPosition=i,f.sPresentationId=o,f.iStateItemNumber=a,f.iSegmentNumber=s,f.iSegmentDuration=u,f.iUsageTime=c,f}return s(n,[{key:"presentationId",get:function(){return this.sPresentationId}},{key:"stateItemNumber",get:function(){return this.iStateItemNumber}},{key:"segmentNumber",get:function(){return this.iSegmentNumber}},{key:"segmentDuration",get:function(){return this.iSegmentDuration}},{key:"streamPosition",get:function(){return this.iStreamPosition}},{key:"usageTime",get:function(){return this.iUsageTime}}]),n}(y),S=function(){function t(){r(this,t)}return s(t,null,[{key:"playbackSpeedConverter",value:function(t){if("string"!=typeof t||""===t||isNaN(parseFloat(t))){if("number"==typeof t)return Number(t.toFixed(2).replace(/(\.0+|0+)$/,""));if(void 0===t||""===t||null===t)return 1;throw new Error("Error in start event: Playback Speed wrong format. No data will be send")}return Number(Number(t).toFixed(2).replace(/(\.0+|0+)$/,""))}}]),t}();function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var P=function(t){m(n,t);var e=w(n);function n(t,i,o,a,s,u,c,l,f,d,h,v,m,p){var g;r(this,n);var y="ondemand"===h?o:-1;return(g=e.call(this,t,y,c,f,l,d,u,n.instance)).fPlaybackSpeedMultiplier=S.playbackSpeedConverter(v.speed),g.sPlayType=h,g.sContentId=i,g.oOptions=v,g.sVisibility=m||"",g.oCustomParams=p||{},g.iStreamStartTime=0===a.length?u-s:Date.parse(a)-s,g}return s(n,[{key:"playType",get:function(){return this.sPlayType},set:function(t){this.sPlayType=t}},{key:"contentId",get:function(){return this.sContentId}},{key:"options",get:function(){return this.oOptions}},{key:"visibility",get:function(){return this.sVisibility}},{key:"customParams",get:function(){return this.oCustomParams}},{key:"streamStartTime",get:function(){return this.iStreamStartTime}}]),n}(k);function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}P.instance="EventPlay";var E=function(t){m(n,t);var e=I(n);function n(t,i,o,a,s,u,c){return r(this,n),e.call(this,t,i,o,s,a,u,c,n.instance)}return n}(k);function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}E.instance="EventStop";var C=function(t){m(n,t);var e=R(n);function n(t,i,o,a,s,u,c){return r(this,n),e.call(this,t,i,o,s,a,u,c,n.instance)}return n}(k);function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}C.instance="EventSkip";var O=function(t){m(n,t);var e=T(n);function n(t,i,o,a,s,u,c,l){var f;return r(this,n),(f=e.call(this,t,i,o,s,a,u,l,n.instance)).sVolume=c,f}return s(n,[{key:"volume",get:function(){return this.sVolume}}]),n}(k);function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}O.instance="EventVolume";var N=function(t){m(n,t);var e=x(n);function n(t,i,o,a,s,u,c,l){var f;return r(this,n),(f=e.call(this,t,i,o,s,a,u,l,n.instance)).sScreen=c,f}return s(n,[{key:"screen",get:function(){return this.sScreen}}]),n}(k);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}N.instance="EventScreen";var D=function(t){m(n,t);var e=A(n);function n(t,i,o,a,s,u,c){return r(this,n),e.call(this,t,i,o,s,a,u,c,n.instance)}return n}(k);function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}D.instance="EventHeartbeat";var H=function(t){m(n,t);var e=L(n);function n(t,i,o){var a;return r(this,n),(a=e.call(this,t,n.instance)).sContentId=i,a.oCustomParams=o||{},a}return s(n,[{key:"contentId",get:function(){return this.sContentId}},{key:"customParams",get:function(){return this.oCustomParams}}]),n}(y);function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}H.instance="EventImpression";var B=function(t){m(n,t);var e=M(n);function n(t,i,o,a,s,u,c,l){var f;return r(this,n),(f=e.call(this,t,i,o,s,a,u,l,n.instance)).sVisibility=c,f}return s(n,[{key:"visibility",get:function(){return this.sVisibility}}]),n}(k);B.instance="EventVisibility";var _=function(){function t(e){r(this,t),this.mediaId=e}return s(t,[{key:"buildEventImpression",value:function(t,e){return new H(this.mediaId,t,e)}},{key:"buildEventPlay",value:function(t,e,n,r,i,o,a,s,u){return new P(this.mediaId,i,t.streamPosition,e,n,r,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,o,a,s,u)}},{key:"buildEventStop",value:function(t,e){return new E(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e)}},{key:"buildEventSkip",value:function(t,e){return new C(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e)}},{key:"buildEventVolume",value:function(t,e,n){return new O(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e,n)}},{key:"buildEventScreen",value:function(t,e,n){return new N(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e,n)}},{key:"buildEventHeartbeat",value:function(t,e){return new D(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e)}},{key:"buildEventVisibility",value:function(t,e,n){return new B(this.mediaId,t.streamPosition,t.presentationId,t.segmentNumber,t.stateItemNumber,t.segmentDuration,e,n)}}]),t}(),q=function(){function t(e,n,i,o,a){r(this,t),this.iStateItemNumber=e,this.iSegmentNumber=n,this.iStreamPosition=i,this.sPresentationId=o,this.iSegmentDuration=a}return s(t,[{key:"presentationId",get:function(){return this.sPresentationId}},{key:"segmentNumber",get:function(){return this.iSegmentNumber}},{key:"stateItemNumber",get:function(){return this.iStateItemNumber}},{key:"segmentDuration",get:function(){return this.iSegmentDuration}},{key:"streamPosition",get:function(){return this.iStreamPosition}}]),t}(),U=function(){function t(){r(this,t)}return s(t,[{key:"hash",value:function(t){var e,n,r,i,o,a,s,u,c,l;for(t=this.Utf8Encode(t),e=this.ConvertToWordArray(t),s=1732584193,u=4023233417,c=2562383102,l=271733878,n=0;n<e.length;n+=16)r=s,i=u,o=c,a=l,s=this.FF(s,u,c,l,e[n+0],7,3614090360),l=this.FF(l,s,u,c,e[n+1],12,3905402710),c=this.FF(c,l,s,u,e[n+2],17,606105819),u=this.FF(u,c,l,s,e[n+3],22,3250441966),s=this.FF(s,u,c,l,e[n+4],7,4118548399),l=this.FF(l,s,u,c,e[n+5],12,1200080426),c=this.FF(c,l,s,u,e[n+6],17,2821735955),u=this.FF(u,c,l,s,e[n+7],22,4249261313),s=this.FF(s,u,c,l,e[n+8],7,1770035416),l=this.FF(l,s,u,c,e[n+9],12,2336552879),c=this.FF(c,l,s,u,e[n+10],17,4294925233),u=this.FF(u,c,l,s,e[n+11],22,2304563134),s=this.FF(s,u,c,l,e[n+12],7,1804603682),l=this.FF(l,s,u,c,e[n+13],12,4254626195),c=this.FF(c,l,s,u,e[n+14],17,2792965006),u=this.FF(u,c,l,s,e[n+15],22,1236535329),s=this.GG(s,u,c,l,e[n+1],5,4129170786),l=this.GG(l,s,u,c,e[n+6],9,3225465664),c=this.GG(c,l,s,u,e[n+11],14,643717713),u=this.GG(u,c,l,s,e[n+0],20,3921069994),s=this.GG(s,u,c,l,e[n+5],5,3593408605),l=this.GG(l,s,u,c,e[n+10],9,38016083),c=this.GG(c,l,s,u,e[n+15],14,3634488961),u=this.GG(u,c,l,s,e[n+4],20,3889429448),s=this.GG(s,u,c,l,e[n+9],5,568446438),l=this.GG(l,s,u,c,e[n+14],9,3275163606),c=this.GG(c,l,s,u,e[n+3],14,4107603335),u=this.GG(u,c,l,s,e[n+8],20,1163531501),s=this.GG(s,u,c,l,e[n+13],5,2850285829),l=this.GG(l,s,u,c,e[n+2],9,4243563512),c=this.GG(c,l,s,u,e[n+7],14,1735328473),u=this.GG(u,c,l,s,e[n+12],20,2368359562),s=this.HH(s,u,c,l,e[n+5],4,4294588738),l=this.HH(l,s,u,c,e[n+8],11,2272392833),c=this.HH(c,l,s,u,e[n+11],16,1839030562),u=this.HH(u,c,l,s,e[n+14],23,4259657740),s=this.HH(s,u,c,l,e[n+1],4,2763975236),l=this.HH(l,s,u,c,e[n+4],11,1272893353),c=this.HH(c,l,s,u,e[n+7],16,4139469664),u=this.HH(u,c,l,s,e[n+10],23,3200236656),s=this.HH(s,u,c,l,e[n+13],4,681279174),l=this.HH(l,s,u,c,e[n+0],11,3936430074),c=this.HH(c,l,s,u,e[n+3],16,3572445317),u=this.HH(u,c,l,s,e[n+6],23,76029189),s=this.HH(s,u,c,l,e[n+9],4,3654602809),l=this.HH(l,s,u,c,e[n+12],11,3873151461),c=this.HH(c,l,s,u,e[n+15],16,530742520),u=this.HH(u,c,l,s,e[n+2],23,3299628645),s=this.II(s,u,c,l,e[n+0],6,4096336452),l=this.II(l,s,u,c,e[n+7],10,1126891415),c=this.II(c,l,s,u,e[n+14],15,2878612391),u=this.II(u,c,l,s,e[n+5],21,4237533241),s=this.II(s,u,c,l,e[n+12],6,1700485571),l=this.II(l,s,u,c,e[n+3],10,2399980690),c=this.II(c,l,s,u,e[n+10],15,4293915773),u=this.II(u,c,l,s,e[n+1],21,2240044497),s=this.II(s,u,c,l,e[n+8],6,1873313359),l=this.II(l,s,u,c,e[n+15],10,4264355552),c=this.II(c,l,s,u,e[n+6],15,2734768916),u=this.II(u,c,l,s,e[n+13],21,1309151649),s=this.II(s,u,c,l,e[n+4],6,4149444226),l=this.II(l,s,u,c,e[n+11],10,3174756917),c=this.II(c,l,s,u,e[n+2],15,718787259),u=this.II(u,c,l,s,e[n+9],21,3951481745),s=this.AddUnsigned(s,r),u=this.AddUnsigned(u,i),c=this.AddUnsigned(c,o),l=this.AddUnsigned(l,a);return(this.WordToHex(s)+this.WordToHex(u)+this.WordToHex(c)+this.WordToHex(l)).toLowerCase()}},{key:"RotateLeft",value:function(t,e){return t<<e|t>>>32-e}},{key:"AddUnsigned",value:function(t,e){var n=2147483648&t,r=2147483648&e,i=1073741824&t,o=1073741824&e,a=(1073741823&t)+(1073741823&e);return i&o?2147483648^a^n^r:i|o?1073741824&a?3221225472^a^n^r:1073741824^a^n^r:a^n^r}},{key:"F",value:function(t,e,n){return t&e|~t&n}},{key:"G",value:function(t,e,n){return t&n|e&~n}},{key:"H",value:function(t,e,n){return t^e^n}},{key:"I",value:function(t,e,n){return e^(t|~n)}},{key:"FF",value:function(t,e,n,r,i,o,a){return t=this.AddUnsigned(t,this.AddUnsigned(this.AddUnsigned(this.F(e,n,r),i),a)),this.AddUnsigned(this.RotateLeft(t,o),e)}},{key:"GG",value:function(t,e,n,r,i,o,a){return t=this.AddUnsigned(t,this.AddUnsigned(this.AddUnsigned(this.G(e,n,r),i),a)),this.AddUnsigned(this.RotateLeft(t,o),e)}},{key:"HH",value:function(t,e,n,r,i,o,a){return t=this.AddUnsigned(t,this.AddUnsigned(this.AddUnsigned(this.H(e,n,r),i),a)),this.AddUnsigned(this.RotateLeft(t,o),e)}},{key:"II",value:function(t,e,n,r,i,o,a){return t=this.AddUnsigned(t,this.AddUnsigned(this.AddUnsigned(this.I(e,n,r),i),a)),this.AddUnsigned(this.RotateLeft(t,o),e)}},{key:"ConvertToWordArray",value:function(t){for(var e,n=t.length,r=n+8,i=16*((r-r%64)/64+1),o=Array(i-1),a=0,s=0;s<n;)a=s%4*8,o[e=(s-s%4)/4]=o[e]|t.charCodeAt(s)<<a,s++;return a=s%4*8,o[e=(s-s%4)/4]=o[e]|128<<a,o[i-2]=n<<3,o[i-1]=n>>>29,o}},{key:"WordToHex",value:function(t){var e,n="",r="";for(e=0;e<=3;e++)n+=(r="0"+(t>>>8*e&255).toString(16)).substr(r.length-2,2);return n}},{key:"Utf8Encode",value:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}}]),t}(),V=function(){function t(e){r(this,t),this.milliseconds=1e3,this.minSegmentDuration=0,this.maxStateItemsNumber=0,this.maxSegmentNumber=0,this.state=1,this.presentationId="",this.streamId="",this.stateItemNumber=0,this.segmentNumber=0,this.playStreamPosition=0,this.streamOffset=0,this.startTime=0,this.toleranceSeconds=3,this.playbackSpeed=1,this.minSegmentDuration=e.minSegmentDuration,this.maxStateItemsNumber=e.maxSegmentStateItems,this.maxSegmentNumber=e.maxSegments,this.md5=new U}return s(t,[{key:"isSegmentStopped",value:function(){return 1===this.state}},{key:"createSegmentStarting",value:function(t,e,n,r,i){if(this.isMaxStateItemNumberReached()||this.isMaxSegmentNumberReached())throw new Error("Max state item number or max segment number reached!");return this.startTime=this.getTimeSeconds(),this.setSegmentAsPlayed(),this.playbackSpeed=r,this.playType=i,this.generateStreamSegment(t,e,n),this.incrementStateItemNumber(),this.incrementSegmentNumber(),this.createSegment(0,n)}},{key:"createSegmentRunning",value:function(t,e){if(this.isSegmentStopped()||this.isMaxStateItemNumberReached())throw new Error("Stream not yet started or max state item number reached!");var n=this.calculateSegmentDuration(t);if(e&&this.isBelowMinSegmentDuration(n))throw new Error("Duration of ".concat(n," ms is below min segment duration of ").concat(this.minSegmentDuration," ms!"));return this.checkSegmentDuration(n),this.incrementStateItemNumber(),this.createSegment(n,t)}},{key:"createSegmentStopping",value:function(t){if(this.isSegmentStopped())throw new Error("Stop called for an already stopped segment");this.setSegmentAsStopped();var e=this.calculateSegmentDuration(t);if(this.isBelowMinSegmentDuration(e))throw new Error("Duration of ".concat(e," ms is below min segment duration of ").concat(this.minSegmentDuration," ms!"));return this.checkSegmentDuration(e),this.incrementStateItemNumber(),this.createSegment(e,t)}},{key:"setStartTime",value:function(t){this.startTime=t}},{key:"setToleranceLimit",value:function(t){this.toleranceSeconds=t}},{key:"checkSegmentDuration",value:function(t){var e=this.getTimeSeconds()-this.startTime+this.toleranceSeconds;if(Math.round(t/1e3)>e*this.playbackSpeed)throw new Error("Segment duration  (".concat(t,") >= actual elapsed time (").concat(e," with playback speed ").concat(this.playbackSpeed,") !"))}},{key:"isBelowMinSegmentDuration",value:function(t){return t<this.minSegmentDuration}},{key:"isMaxStateItemNumberReached",value:function(){return this.maxStateItemsNumber<this.getStateItemNumber()}},{key:"isMaxSegmentNumberReached",value:function(){return this.maxSegmentNumber<this.getSegmentNumber()}},{key:"getTimeSeconds",value:function(){return Math.round(this.getTimeMilliseconds()/this.milliseconds)}},{key:"getTimeMilliseconds",value:function(){return Date.now()}},{key:"setSegmentAsPlayed",value:function(){this.state=0}},{key:"setSegmentAsStopped",value:function(){this.state=1}},{key:"getPresentationId",value:function(){return this.presentationId}},{key:"calculateDuration",value:function(t){return"live"===this.playType?Math.round(t*this.playbackSpeed):t}},{key:"calculateSegmentDuration",value:function(t){var e=this.getCurrentStreamPosition(t)-this.playStreamPosition;return this.calculateDuration(e)}},{key:"getCurrentStreamPosition",value:function(t){return t-this.streamOffset}},{key:"getStateItemNumber",value:function(){return this.stateItemNumber}},{key:"getSegmentNumber",value:function(){return this.segmentNumber}},{key:"incrementStateItemNumber",value:function(){this.stateItemNumber++}},{key:"incrementSegmentNumber",value:function(){this.segmentNumber++}},{key:"generateStreamSegment",value:function(t,e,n){this.isStreamIdChanged(e)&&(this.streamId=e,this.presentationId=this.generatePresentationId(e),this.stateItemNumber=0,this.segmentNumber=0),this.streamOffset=t,this.playStreamPosition=this.getCurrentStreamPosition(n)}},{key:"isStreamIdChanged",value:function(t){return this.streamId!==t}},{key:"generatePresentationId",value:function(t){var e=this.getRndInt(1e6,9999999);return this.md5.hash(t).toUpperCase()+e+this.getTimeMilliseconds()}},{key:"getRndInt",value:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}},{key:"createSegment",value:function(t,e){return new q(this.getStateItemNumber(),this.getSegmentNumber(),this.getCurrentStreamPosition(e),this.getPresentationId(),t)}}]),t}(),F=function(){function t(e){r(this,t),this.requestType=e,this.fields={ty:e}}return s(t,[{key:"projectId",set:function(t){this.fields.p=t}},{key:"mediaId",set:function(t){this.fields.m=t}},{key:"technology",set:function(t){this.fields.t=t}},{key:"version",set:function(t){this.fields.v=t}},{key:"operatingSystem",set:function(t){this.fields.os=t}},{key:"appType",set:function(t){this.fields.at=t}},{key:"deviceType",get:function(){return this.fields.dt},set:function(t){this.fields.dt=t}},{key:"getAsUrlString",value:function(){var t="";for(var e in this.fields)if(this.fields.hasOwnProperty(e)){var n=this.fields[e];"object"===o(n)&&(n=JSON.stringify(n)),t+=e+"="+this.encode(n)+"&"}return t.substring(0,t.length-1)}},{key:"customParameter",set:function(t){var e=t.userParams,n=t.allowedParams;for(var r in e)e.hasOwnProperty(r)&&-1!==n.indexOf(r)&&(this.fields["cp_"+r]=e[r])}},{key:"encode",value:function(t){return encodeURIComponent(t)}}]),t}();function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var G=function(t){m(n,t);var e=j(n);function n(t){return r(this,n),e.call(this,t)}return s(n,[{key:"presentationId",get:function(){return this.fields.pr},set:function(t){this.fields.pr=t}},{key:"requestNumber",set:function(t){this.fields.rn=t.toString()}},{key:"segmentNumber",get:function(){return parseInt(this.fields.sn,10)},set:function(t){this.fields.sn=t.toString()}},{key:"segmentDuration",set:function(t){this.fields.sd=Math.round(t/1e3).toString(),this.fields.vt=this.fields.sd}},{key:"streamTime",set:function(t){this.fields.st=Math.round(t/1e3).toString(),this.fields.ct=this.fields.st}},{key:"usageTime",set:function(t){this.fields.ut=Math.round(t/1e3).toString()}}]),n}(F);function W(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var K=function(t){m(n,t);var e=W(n);function n(){var t;return r(this,n),(t=e.call(this,"HB")).isMostRecent=!0,t}return n}(G);function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var Y=function(t){m(n,t);var e=X(n);function n(){return r(this,n),e.call(this,"PL")}return s(n,[{key:"contentId",set:function(t){this.fields.c=t}},{key:"streamPosition",set:function(t){this.fields.sp=-1===t?"-1":Math.round(t/1e3).toString(),this.fields.vp=this.fields.sp}},{key:"playbackSpeed",set:function(t){this.fields.ps=t.toString()}},{key:"visibility",set:function(t){this.fields.vb=t}},{key:"screen",set:function(t){this.fields.sc=t}},{key:"volume",set:function(t){this.fields.vo=t}},{key:"instanceid",set:function(t){this.fields.instanceid=t}},{key:"origin",set:function(t){this.fields.r=t}},{key:"userAgent",set:function(t){this.fields.ua=t}},{key:"language",set:function(t){this.fields.l=t}}]),n}(G);function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var $=function(t){m(n,t);var e=Q(n);function n(){return r(this,n),e.call(this,"SC")}return s(n,[{key:"screen",set:function(t){this.fields.sc=t}}]),n}(G);function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var J=function(t){m(n,t);var e=z(n);function n(){return r(this,n),e.call(this,"ST")}return s(n,[{key:"skip",set:function(t){this.fields.sk=t.toString()}}]),n}(G);function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var tt=function(t){m(n,t);var e=Z(n);function n(){return r(this,n),e.call(this,"VO")}return s(n,[{key:"volume",set:function(t){this.fields.vo=t}}]),n}(G);function et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var nt=function(t){m(n,t);var e=et(n);function n(){return r(this,n),e.call(this,"IM")}return s(n,[{key:"contentId",set:function(t){this.fields.c=t}},{key:"instanceid",set:function(t){this.fields.instanceid=t}},{key:"origin",set:function(t){this.fields.r=t}},{key:"userAgent",set:function(t){this.fields.ua=t}},{key:"language",set:function(t){this.fields.l=t}}]),n}(F);function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}var it=function(t){m(n,t);var e=rt(n);function n(){return r(this,n),e.call(this,"VB")}return s(n,[{key:"visibility",set:function(t){this.fields.vb=t}}]),n}(G),ot=function(){function t(e){r(this,t),this.collector=e}return s(t,[{key:"buildRequest",value:function(t){var e;switch(t.instance){case"EventImpression":e=this.buildRequestImpression(t);break;case"EventPlay":e=this.buildRequestPlay(t);break;case"EventStop":e=this.buildRequestStop(t);break;case"EventSkip":e=this.buildRequestSkip(t);break;case"EventVolume":e=this.buildRequestVolume(t);break;case"EventScreen":e=this.buildRequestScreen(t);break;case"EventHeartbeat":e=this.buildRequestHeartbeat(t);break;case"EventVisibility":e=this.buildRequestVisibility(t)}return e}},{key:"buildRequestImpression",value:function(t){var e=this.buildRequestCommon(new nt,t);return e.contentId=t.contentId,e.instanceid=d.getInstanceID(),e.userAgent=d.getUserAgent(),e.language=this.collector.getLanguage(),e.origin=this.collector.getOrigin(),e.customParameter={userParams:t.customParams,allowedParams:this.collector.getContentCustomParameter()},e}},{key:"buildRequestPlay",value:function(t){var e=this.buildRequestBase(new Y,t);return e.contentId=t.contentId,e.volume=t.options.volume||"",e.visibility=t.visibility,e.screen=t.options.screen||"",e.instanceid=d.getInstanceID(),e.userAgent=d.getUserAgent(),e.language=this.collector.getLanguage(),e.origin=this.collector.getOrigin(),e.streamPosition=t.streamPosition,e.streamTime=t.streamStartTime,e.playbackSpeed=S.playbackSpeedConverter(t.options.speed),e.customParameter={userParams:t.customParams,allowedParams:this.collector.getStreamCustomParameter()},e}},{key:"buildRequestStop",value:function(t){var e=this.buildRequestBase(new J,t);return e.skip=0,e}},{key:"buildRequestSkip",value:function(t){var e=this.buildRequestBase(new J,t);return e.skip=1,e}},{key:"buildRequestVolume",value:function(t){var e=this.buildRequestBase(new tt,t);return e.volume=t.volume,e}},{key:"buildRequestScreen",value:function(t){var e=this.buildRequestBase(new $,t);return e.screen=t.screen,e}},{key:"buildRequestHeartbeat",value:function(t){return this.buildRequestBase(new K,t)}},{key:"buildRequestVisibility",value:function(t){var e=this.buildRequestBase(new it,t);return e.visibility=t.visibility,e}},{key:"buildRequestBase",value:function(t,e){return(t=this.buildRequestCommon(t,e)).presentationId=e.presentationId,t.requestNumber=e.stateItemNumber,t.segmentNumber=e.segmentNumber,t.segmentDuration=e.segmentDuration,t.usageTime=e.usageTime,t}},{key:"buildRequestCommon",value:function(t,e){return t.projectId=this.collector.getProjectName(),t.mediaId=e.mediaId,t.technology=this.collector.getTechnology(),t.version=this.collector.getVersion(),t.operatingSystem=d.getOperatingSystem(),t.deviceType=this.getDeviceType(t.requestType),t.appType=this.collector.getAppType(),t}},{key:"getDeviceType",value:function(t){var e=this.lastDeviceType;return void 0!==e&&"PL"!==t||(e=this.lastDeviceType=this.collector.getDeviceType()),e}}]),t}(),at=function(){function t(e,n){r(this,t),this.eventBuilder=new _(e),this.segmentBuilder=new V(n.getSegmentSettings()),this.requestBuilder=new ot(n)}return s(t,[{key:"getSegmentBuilder",value:function(){return this.segmentBuilder}},{key:"getEventBuilder",value:function(){return this.eventBuilder}},{key:"getRequestBuilder",value:function(){return this.requestBuilder}}]),t}();function st(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ut(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ct=function(){function t(e,n){r(this,t),this.milliseconds=1e3,this.heartbeatNumber=0,this.intervalId=0,this.timeoutId=[],this.buildHeartbeat=e,this.heartbeatConfig=n,this.extendTimeoutIntervallWithParamsForOldIE()}return s(t,[{key:"start",value:function(){var t=this;if(this.stop(),this.isHeartbeatEnabled()&&!(this.heartbeatConfig.interval.length<1)&&"undefined"!=typeof window){this.heartbeatNumber=0;var e,n=this.heartbeatConfig.interval.slice(),r=n.pop(),i=0,o=st(n);try{for(o.s();!(e=o.n()).done;){i+=e.value,this.timeoutId.push(window.setTimeout(this.buildHeartbeatEvent,i*this.milliseconds,this))}}catch(t){o.e(t)}finally{o.f()}i+=r,this.timeoutId.push(window.setTimeout((function(){t.buildHeartbeatEvent(t),t.intervalId=window.setInterval(t.buildHeartbeatEvent,r*t.milliseconds,t)}),i*this.milliseconds))}}},{key:"stop",value:function(){var t,e=st(this.timeoutId);try{for(e.s();!(t=e.n()).done;){var n=t.value;clearTimeout(n)}}catch(t){e.e(t)}finally{e.f()}clearInterval(this.intervalId),this.timeoutId=[],this.intervalId=0}},{key:"isHeartbeatActive",value:function(){return this.intervalId>0}},{key:"getMaxHeartbeatInterval",value:function(){var t=0;return this.isHeartbeatEnabled()&&this.heartbeatConfig.interval.length>0&&(t=Math.max.apply(Math,this.heartbeatConfig.interval)),t}},{key:"buildHeartbeatEvent",value:function(t){t.isMaxHeartbeatReached()?t.stop():(t.heartbeatNumber++,t.buildHeartbeat())}},{key:"isHeartbeatEnabled",value:function(){return this.heartbeatConfig.enabled}},{key:"isMaxHeartbeatReached",value:function(){return 0!==this.heartbeatConfig.maximum&&this.heartbeatNumber>=this.heartbeatConfig.maximum}},{key:"extendTimeoutIntervallWithParamsForOldIE",value:function(){if("undefined"!=typeof window){if(document.all){var t=window.setTimeout;window.setTimeout=function(e,n){var r=this,i=Array.prototype.slice.call(arguments,2);return t(e instanceof Function?function(){e.apply(r,i)}:e,n)}}if(document.all){var e=window.setInterval;window.setInterval=function(t,n){var r=this,i=Array.prototype.slice.call(arguments,2);return e(t instanceof Function?function(){t.apply(r,i)}:t,n)}}}}}]),t}(),lt=function(){function t(e){r(this,t),this.timeWithOffsetCallback=e}return s(t,[{key:"setPlayType",value:function(t){this.playType=t}},{key:"setStreamPositionCallback",value:function(t){this.streamPositionCallback=t}},{key:"getCurrentStreamPosition",value:function(){var t=0;switch(this.playType){case"live":t=this.getCurrentStreamPositionLive();break;case"ondemand":t=this.getCurrentStreamPositionOnDemand()}return t}},{key:"getCurrentStreamPositionLive",value:function(){return this.timeWithOffsetCallback()}},{key:"getCurrentStreamPositionOnDemand",value:function(){var t=0;try{t=this.streamPositionCallback()}catch(t){throw new Error("Error while executing stream position callback: "+t.message)}if("number"!=typeof t||t<0)throw new Error("Stream position must be a positive milliseconds value, but is ".concat(t,"."));return l.output("Stream position: ".concat(l.formatDuration(t)," (").concat(t,")"),"log"),t}}]),t}(),ft=function(){function t(e){r(this,t),this.skipAllAfterValidationError=!1,this.lastPosition=0,this.heartbeat=e}return s(t,[{key:"start",value:function(t){if(t<0)throw this.skipAllAfterValidationError=!0,new Error("Position must be >= 0.");this.skipAllAfterValidationError=!1,this.lastPosition=t}},{key:"validate",value:function(t){if(this.skipAllAfterValidationError)throw new Error("Event skipped after validation error!");if(t<this.lastPosition)throw new Error("Current position (".concat(t,") is less than last position (").concat(this.lastPosition,")."));this.heartbeat.isHeartbeatActive()&&this.skipIfItemIntervalLargerThanHbInterval(t)}},{key:"updateLastPosition",value:function(t){this.lastPosition=t}},{key:"skipIfItemIntervalLargerThanHbInterval",value:function(e){var n=e-this.lastPosition,r=1e3*(this.heartbeat.getMaxHeartbeatInterval()+t.toleranceSeconds);if(n>r){this.heartbeat.stop(),this.skipAllAfterValidationError=!0;var i="Time interval since last segment is ".concat(n," ms, should be < ").concat(r," ms.");throw i+=" Last: ".concat(this.lastPosition,", current: ").concat(e,"."),l.output(i,"error"),new Error(i)}}}]),t}();ft.toleranceSeconds=300;var dt=function(){function t(){r(this,t),this.mostRecentHeartbeats={}}return s(t,[{key:"onNewHeartbeatGenerated",value:function(t){t.isMostRecent=!0,this.invalidateMostRecentHeartbeat(t),this.storeAsMostRecentHeartbeat(t)}},{key:"invalidateMostRecentHeartbeat",value:function(t){var e=t.presentationId,n=t.segmentNumber;this.mostRecentHeartbeats[e]&&this.mostRecentHeartbeats[e][n]&&(this.mostRecentHeartbeats[e][n].isMostRecent=!1)}},{key:"storeAsMostRecentHeartbeat",value:function(t){var e,n,r,i=t.presentationId,o=t.segmentNumber;this.mostRecentHeartbeats[i]=(r=t,(n=o)in(e={})?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e)}}]),t}(),ht=function(){function t(e){r(this,t),this.sendTo=e}return s(t,[{key:"send",value:function(t){var e,n=new Promise((function(t,n){e=function(e){return e?t():n("Sending request failed")}}));return this.isWebContext()?this.isIEContext()?this.sendWithOldIE(t,e):this.sendWithDefault(t,e):this.sendNotInBrowser(e),n}},{key:"sendWithDefault",value:function(t,e){if(XMLHttpRequest){var n=new XMLHttpRequest;if(!("withCredentials"in n))return l.output("withCredentials not possible on XMLHttpRequest","error"),void e(!1);n.open("POST",this.sendTo,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4===n.readyState&&(204===n.status?e(!0):e(!1))},n.send(t.getAsUrlString())}else l.output("XMLHttpRequest not found","error"),e(!1)}},{key:"sendWithOldIE",value:function(t,e){var n=new XDomainRequest;n.open("POST",this.sendTo),n.onerror=function(){l.output("Can't send a request with old IE","error"),e(!1)},n.ontimeout=function(){l.output("Server status unknown, POST data not sent!","error"),e(!1)},n.onload=function(){l.output(t.requestType,"log","request",t.fields),e(!0)},n.send(t.getAsUrlString())}},{key:"sendNotInBrowser",value:function(t){l.output("Cannot send xhttp request, not in a browser","warn"),t(!0)}},{key:"isWebContext",value:function(){return"undefined"!=typeof window}},{key:"isIEContext",value:function(){return"undefined"!=typeof XDomainRequest}}]),t}(),vt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},mt=function(){function t(e){r(this,t),this.storage=[],this.currentDelay=t.BASE_DELAY,this.isResendQueued=!1,this.requestSender=new ht(e)}return s(t,[{key:"sendRequest",value:function(t){var e=this;return this.requestSender.send(t).then((function(){return l.output("Sent: "+t.requestType,"log","request",t.fields)})).catch((function(n){l.output("Failed to send request: "+n,"error"),pt(t)&&(l.output("Queueing request","info"),e.storage.push(t)),e.isResendQueued||(l.output("No re-sending active, starting new re-sending after "+e.currentDelay+" ms","info"),e.scheduleNextResend())}))}},{key:"resend",value:function(){return vt(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.storage.length>0)){e.next=17;break}return r=this.storage.shift(),e.prev=2,e.next=5,this.requestSender.send(r);case 5:e.next=15;break;case 7:return e.prev=7,e.t0=e.catch(2),pt(r)&&this.storage.unshift(r),this.increaseDelay(),l.output("Failed to re-send request: "+e.t0,"error"),l.output("Increasing re-send delay to "+this.currentDelay,"info"),this.scheduleNextResend(),e.abrupt("break",17);case 15:e.next=0;break;case 17:0===this.storage.length&&(l.output("All requests flushed","info"),this.isResendQueued=!1,this.currentDelay=t.BASE_DELAY);case 18:case"end":return e.stop()}}),n,this,[[2,7]])})))}},{key:"scheduleNextResend",value:function(){var t=this;setTimeout((function(){return t.resend()}),this.currentDelay),this.isResendQueued=!0}},{key:"increaseDelay",value:function(){this.currentDelay=Math.min(2*this.currentDelay,t.MAX_DELAY)}},{key:"_requestSender",get:function(){return this.requestSender}}]),t}();function pt(t){return!("HB"===t.requestType)||t.isMostRecent}mt.MAX_DELAY=32e3,mt.BASE_DELAY=500;var gt,yt=function(){function t(e,n,i){var o=this;r(this,t),this.heartbeatInvalidator=new dt,this.htmlPlayerId=i,d.setConfig(n),this.collector=new d(e),this.streamPositionManager=new lt(d.getTimeWithOffset),this.builder=new at(e.media,this.collector),this.transmitter=new mt(n.trackingUrl),this.heartbeat=new ct((function(){l.output("Triggered: HB","log","fcall"),o.createEventHeartbeat()}),n.heartbeat),this.itemValidator=new ft(this.heartbeat)}return s(t,[{key:"setStreamPositionCallback",value:function(t){this.streamPositionManager.setStreamPositionCallback(t)}},{key:"isPlaying",value:function(){return!this.builder.getSegmentBuilder().isSegmentStopped()}},{key:"createEventImpression",value:function(t,e){try{var n=this.builder.getEventBuilder().buildEventImpression(t,e),r=this.builder.getRequestBuilder().buildRequest(n);this.send(r)}catch(t){l.output("Error in impression event: "+t.message,"error")}}},{key:"createEventPlayLive",value:function(t,e,n,r,i,o){try{this.streamPositionManager.setPlayType("live");var a=this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.start(a);var s=this.builder.getSegmentBuilder().createSegmentStarting(n,r,a,S.playbackSpeedConverter(i.speed),"live");this.heartbeat.start();var u=d.getTimeWithOffset(),c=this.builder.getEventBuilder().buildEventPlay(s,e,n,u,t,"live",i,"",o),f=this.builder.getRequestBuilder().buildRequest(c);this.send(f)}catch(t){l.output("Error in play (live) event: "+t.message,"error")}}},{key:"createEventPlayOnDemand",value:function(t,e,n,r){var i;try{this.streamPositionManager.setPlayType("ondemand");var o=null!==(i=n.position)&&void 0!==i?i:this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.start(o);var a=this.builder.getSegmentBuilder().createSegmentStarting(0,e,o,S.playbackSpeedConverter(n.speed),"ondemand");this.heartbeat.start();var s=d.getTimeWithOffset(),u=this.builder.getEventBuilder().buildEventPlay(a,"",0,s,t,"ondemand",n,"",r),c=this.builder.getRequestBuilder().buildRequest(u);this.send(c)}catch(t){l.output("Error in play (on demand) event: "+t.message,"error")}}},{key:"createEventStop",value:function(t){var e=!1;try{var n=null!=t?t:this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(n);var r=this.builder.getSegmentBuilder().createSegmentStopping(n),i=d.getTimeWithOffset(),o=this.builder.getEventBuilder().buildEventStop(r,i),a=this.builder.getRequestBuilder().buildRequest(o);this.send(a),e=!0,this.itemValidator.updateLastPosition(n)}catch(t){l.output("Error in stop event: "+t.message,"error")}return this.heartbeat.stop(),e}},{key:"createEventSkip",value:function(t){var e=!1;try{var n=null!=t?t:this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(n);var r=this.builder.getSegmentBuilder().createSegmentStopping(n),i=d.getTimeWithOffset(),o=this.builder.getEventBuilder().buildEventSkip(r,i),a=this.builder.getRequestBuilder().buildRequest(o);this.send(a),e=!0,this.itemValidator.updateLastPosition(n)}catch(t){l.output("Error in skip event: "+t.message,"error")}return this.heartbeat.stop(),e}},{key:"createEventHeartbeat",value:function(){try{var t=this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(t);var e=this.builder.getSegmentBuilder().createSegmentRunning(t,!0),n=d.getTimeWithOffset(),r=this.builder.getEventBuilder().buildEventHeartbeat(e,n),i=this.builder.getRequestBuilder().buildRequest(r);this.send(i),this.heartbeatInvalidator.onNewHeartbeatGenerated(i),this.itemValidator.updateLastPosition(t)}catch(t){l.output("Error in heartbeat event: "+t.message,"error")}}},{key:"createEventVisibility",value:function(t){try{var e=this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(e);var n=this.builder.getSegmentBuilder().createSegmentRunning(e,!1),r=d.getTimeWithOffset(),i=this.builder.getEventBuilder().buildEventVisibility(n,t,r),o=this.builder.getRequestBuilder().buildRequest(i);this.send(o),this.itemValidator.updateLastPosition(e)}catch(t){l.output("Error in visibility event: "+t.message,"error")}}},{key:"createEventScreen",value:function(t){try{var e=this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(e);var n=this.builder.getSegmentBuilder().createSegmentRunning(e,!0),r=d.getTimeWithOffset(),i=this.builder.getEventBuilder().buildEventScreen(n,t,r),o=this.builder.getRequestBuilder().buildRequest(i);this.send(o),this.itemValidator.updateLastPosition(e)}catch(t){l.output("Error in screen event: "+t.message,"error")}}},{key:"createEventVolume",value:function(t){try{var e=this.streamPositionManager.getCurrentStreamPosition();this.itemValidator.validate(e);var n=this.builder.getSegmentBuilder().createSegmentRunning(e,!0),r=d.getTimeWithOffset(),i=this.builder.getEventBuilder().buildEventVolume(n,t,r),o=this.builder.getRequestBuilder().buildRequest(i);this.send(o),this.itemValidator.updateLastPosition(e)}catch(t){l.output("Error in volume event: "+t.message,"error")}}},{key:"isProjectEnabled",value:function(){return!0===this.collector.getProjectStatus()}},{key:"send",value:function(t){this.isProjectEnabled()&&this.transmitter.sendRequest(t)}}]),t}(),bt=function(){function t(e,n,i,o){(r(this,t),h.validateTagConfig(e),void 0===o)&&(o=window.s2sSdkConfig);this.processor=new yt(e,o,n),"function"==typeof i&&this.setStreamPositionCallback(i)}return s(t,[{key:"impression",value:function(t,e){var n="impression()";l.output("Triggered: "+n,"log","fcall",arguments),h.checkArgCount(arguments.length,2,n);var r={contentId:h.isStringAndNotEmpty(t,"contentId",n),customParams:h.areCustomParametersValid(e,"customParams",n)},i=h.areParameterValid(r);return i&&this.processor.createEventImpression(t,e),r}},{key:"playStreamLive",value:function(t,e,n,r,i,o){var a="playStreamLive()";l.output("Triggered: "+a,"log","fcall",arguments),h.checkArgCount(arguments.length,6,a);var s={contentId:h.isStringAndNotEmpty(t,"contentId",a),streamStart:h.isCorrectStreamStart(e,"streamStart",a),streamOffset:h.isCorrectStreamOffset(n,"streamOffset",a),streamId:h.isStringAndNotEmpty(r,"streamId",a),options:h.isPlayOptionsValid(i,"options",a,!1),customParams:h.areCustomParametersValid(o,"customParams",a)},u=h.areParameterValid(s);return u&&this.processor.createEventPlayLive(t,e,n,r,i,o),s}},{key:"playLive",value:function(t,e,n,r,i,o,a){var s="playLive()";h.checkArgCount(arguments.length,7,s);var u={screen:i,volume:o};return this.playStreamLive(t,e,n,r,u,a)}},{key:"playStreamOnDemand",value:function(t,e,n,r,i){var o,a="playStreamOnDemand()";if(l.output("Triggered: "+a,"log","fcall",arguments),"number"==typeof n){h.checkArgCount(arguments.length,5,a);var s=Object.assign(Object.assign({},r),{position:n}),u=i;o={contentId:h.isStringAndNotEmpty(t,"contentId",a),streamId:h.isStringAndNotEmpty(e,"streamId",a),options:h.isPlayOptionsValid(s,"options",a,!0),customParams:h.areCustomParametersValid(u,"customParams",a)};var c=h.areParameterValid(o);c&&this.processor.createEventPlayOnDemand(t,e,s,u)}else{h.checkArgCount(arguments.length,4,a);var f=n,d=r;o={contentId:h.isStringAndNotEmpty(t,"contentId",a),streamId:h.isStringAndNotEmpty(e,"streamId",a),options:h.isPlayOptionsValid(f,"options",a,!0),customParams:h.areCustomParametersValid(d,"customParams",a)};var v=h.areParameterValid(o);v&&this.processor.createEventPlayOnDemand(t,e,f,d)}return o}},{key:"playVOD",value:function(t,e,n,r,i){var o="playVOD()";h.checkArgCount(arguments.length,5,o);var a={screen:n,volume:r};return this.playStreamOnDemand(t,e,a,i)}},{key:"stop",value:function(t){return l.output("Triggered: stop()","log","fcall",t),{stop:this.processor.createEventStop(t)}}},{key:"skip",value:function(t){return l.output("Triggered: skip()","log","fcall"),{skip:this.processor.createEventSkip(t)}}},{key:"volume",value:function(t){var e="volume()";l.output("Triggered: "+e,"log","fcall",t),h.checkArgCount(arguments.length,1,e);var n={volume:h.isStringAndNotEmpty(t,"volume",e)};return this.processor.isPlaying()&&this.processor.createEventVolume(t),n}},{key:"screen",value:function(t){var e="screen()";l.output("Triggered: "+e,"log","fcall",t),h.checkArgCount(arguments.length,1,e);var n={screen:h.isStringAndNotEmpty(t,"screen",e)};return this.processor.isPlaying()&&this.processor.createEventScreen(t),n}},{key:"setStreamPositionCallback",value:function(t){this.processor.setStreamPositionCallback(t)}}]),t}();function kt(){for(var t=Date.now().toString().substring(0,13).padStart(13,"0"),e="ABCDEF0123456789",n=e.length,r=56-t.length,i=0;i<r;i++)t+=e.charAt(Math.floor(Math.random()*n));return t}!function(t){t[t.NOT_ALLOWED=0]="NOT_ALLOWED",t[t.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",t[t.REQUIRE_LI=2]="REQUIRE_LI"}(gt||(gt={}));var St=function(){function t(){r(this,t)}return s(t,null,[{key:"isValidTCData",value:function(t){return!!(t.vendor&&t.vendor.consents&&t.vendor.legitimateInterests&&t.purpose&&t.purpose.consents&&t.purpose.legitimateInterests)}},{key:"hasReadWrite",value:function(e){return t.hasPurpose(t.PURPOSE_READ_WRITE_ON_USER_DEVICE,e)}},{key:"hasMeasureAdPerformance",value:function(e){return t.hasPurpose(t.PURPOSE_MEASURE_AD_PERFORMANCE,e)}},{key:"hasMeasureContentPerformance",value:function(e){return t.hasPurpose(t.PURPOSE_MEASURE_CONTENT_PERFORMANCE,e)}},{key:"hasMarketResearch",value:function(e){return t.hasPurpose(t.PURPOSE_MARKET_RESEARCH,e)}},{key:"hasGfK",value:function(e){return t.isValidTCData(e)&&!0===e.vendor.consents[t.VENDOR_ID]}},{key:"hasPurpose",value:function(e,n){var r,i,o=null===(i=null===(r=n.publisher)||void 0===r?void 0:r.restrictions[e])||void 0===i?void 0:i[t.VENDOR_ID];return(void 0===o||o!==gt.NOT_ALLOWED)&&(t.isValidTCData(n)&&!0===n.purpose.consents[e])}}]),t}();St.VENDOR_ID=758,St.PURPOSE_READ_WRITE_ON_USER_DEVICE=1,St.PURPOSE_MEASURE_AD_PERFORMANCE=7,St.PURPOSE_MEASURE_CONTENT_PERFORMANCE=8,St.PURPOSE_MARKET_RESEARCH=9;var wt=function t(){r(this,t)};wt.version="2.2.2",wt.suiGeneratorUrl="es-config.sensic.net/suigenerator",wt.thirdPartyCookieIframeUrl="https://es-config.sensic.net/3pc.html",wt.panelcookie=["MEPP","GFKP","GFKM"],wt.suiPixelUrl=".trk.sensic.net/tp.gif",wt.suiHtmlUrl="https://es-config.sensic.net/sui.html",wt.filecacheUrl="https://es-config.sensic.net/sui_fc",wt.featureFlagTcf=!0,wt.suiLogging=1,wt.projectId="es1",wt.trackingUrl="https://es1-s2s.sensic.net";var Pt={TCF:wt.featureFlagTcf},It=function(){function t(){r(this,t)}return s(t,null,[{key:"isEnabled",value:function(t){return!0===Pt[t]}}]),t}();function Et(t){var e=t.optin,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(t){return n?t(!0):void 0!==e?t(e):(setTimeout((function(){t(!1)}),1e4),void(window.__tcfapi&&It.isEnabled("TCF")?window.__tcfapi("addEventListener",2,(function(n,r){r||t(!1),n.gdprApplies||(t(e),window.__tcfapi("removeEventListener",2,(function(){}),n.listenerId)),!r||"tcloaded"!==n.eventStatus&&"useractioncomplete"!==n.eventStatus||(t(Rt(n)),window.__tcfapi("removeEventListener",2,(function(){}),n.listenerId))})):t(!0)))}))}function Rt(t){return St.hasGfK(t)&&St.hasMarketResearch(t)&&St.hasMeasureAdPerformance(t)&&St.hasMeasureContentPerformance(t)&&St.hasReadWrite(t)}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ot=function(){function t(){r(this,t)}return s(t,null,[{key:"sendData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(i,o){var a=new XMLHttpRequest;a.onloadend=function(){a.status>=200&&a.status<400?(r&&r(a),i()):o()},a.open(e,t,!0),a.setRequestHeader("Content-Type","text/plain"),n?a.send(JSON.stringify(n)):a.send()}))}}]),t}(),xt=function(){function t(){r(this,t)}return s(t,null,[{key:"getCookie",value:function(t){var e=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return e?decodeURIComponent(e[2]):null}},{key:"deleteCookie",value:function(t,e){this.setCookie(t,"",{days:-1,domain:e})}},{key:"setCookie",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.days,i=void 0===r?730:r,o=n.domain,a=n.sameSite,s=void 0===a?"None":a,u=new Date;u.setTime(u.getTime()+24*i*60*60*1e3);var c=t+"="+encodeURIComponent(e)+";path=/;expires="+u.toUTCString();o&&(c+=";domain="+o),c+=";sameSite="+s,"https:"===window.location.protocol&&(c+=";secure"),document.cookie=c}},{key:"isHttp",value:function(){if("undefined"!=typeof window){for(var t=window.document.getElementsByTagName("script"),e=0;e<t.length;e++)if(t[e]&&t[e].src.match(/\/\/[^/]*sensic.net\/\S*\.js$/))return null!==t[e].src.match(/^http:/);if("http:"===window.location.protocol)return!0}return!1}}]),t}(),Nt="sui_1pc";function At(){if(!xt.getCookie(Nt)){var t=kt();xt.setCookie(Nt,t,{sameSite:"Lax"})}return xt.getCookie(Nt)}var Dt=/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/i;var Lt="sensic_sui_3pc",Ht="sensic_sui_old_3pc";function Mt(t,e){var n=new Promise((function(t,n){setTimeout((function(){return n("No value returned after ".concat(e," ms"))}),e)}));return Promise.race([t,n])}var Bt,_t,qt,Ut=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Vt=1e4;function Ft(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];void 0===Bt&&jt();var n={};return e&&(qt=Mt(Gt(Ht),Vt),setTimeout((function(){Bt.contentWindow.postMessage({readOldCookie:!0},"*")}),500),n.oldCookie=qt),t&&(_t=Mt(Gt(Lt),Vt),Bt.contentWindow.postMessage({readNewCookie:!0},"*"),n.newCookie=_t),n}function jt(){(Bt=document.createElement("iframe")).style.visibility="hidden",Bt.style.display="none",Bt.width="0",Bt.height="0",Bt.src=wt.thirdPartyCookieIframeUrl.replace(/^https?:/,xt.isHttp()?"http:":"https:");var t,e,n=document.body.childNodes[0];t=Bt,(e=n)&&e.parentNode?e.parentNode.insertBefore(t,e.nextSibling):document.body.appendChild(t)}function Gt(t){return new Promise((function(e){window.addEventListener("message",(function(n){n.data.hasOwnProperty(t)&&e(n.data[t])}))}))}function Wt(){var t;return Ut(this,void 0,void 0,e().mark((function n(){var r,i,o;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ft(),i=r.oldCookie,o=null,void 0===(null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.nodeName)){e.next=12;break}return e.prev=3,e.next=6,i;case 6:o=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),l.warn("Failed to collect oldCookie: "+e.t0.toString());case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),n,null,[[3,9]])})))}function Kt(){var t="https://fc-id.sensic.net/".replace(/^https?:/,xt.isHttp()?"http:":"https:");return new Promise((function(e,n){var r=new XMLHttpRequest;r.onloadend=function(){r.status>=200&&r.status<=299?e(r.response):n("".concat(t," returned ").concat(r.status))},r.open("GET",t,!0),r.send()}))}var Xt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function Yt(){return Mt(new Promise((function(t,e){It.isEnabled("TCF")||e("TCF feature flag is disabled"),window.__tcfapi||e("No __tcfapi found."),window.__tcfapi("getTCData",2,(function(e,n){!n||"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||t(e.tcString)}),[758])})),1e3)}function Qt(){return Xt(this,void 0,void 0,e().mark((function t(){var n,r,i,o,a,s,u,c,f,d,h;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Ft(!0),r=n.oldCookie,i=n.newCookie,o=[["sui_1pc",At()],["ai",(e=void 0,v=void 0,v=null===(e=null===window||void 0===window?void 0:window.gfkS2sConf)||void 0===e?void 0:e.ai,Dt.test(v)&&"00000000-0000-0000-0000-000000000000"!==v?v:null)],["sui_fc",Kt()],["sui_3pc",i],["sui_old_3pc",r],["external",window.gfkS2sConf?window.gfkS2sConf.extID:window.gfkConnectorConf?window.gfkConnectorConf.extID:void 0]],a={},s=0,u=o;case 4:if(!(s<u.length)){t.next=19;break}return c=Tt(u[s],2),f=c[0],d=c[1],t.prev=6,t.next=9,d;case 9:(h=t.sent)&&(a[f]=h),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(6),l.warn("Failed to collect ID '".concat(f,"': ")+t.t0.toString());case 16:s++,t.next=4;break;case 19:return t.abrupt("return",a);case 20:case"end":return t.stop()}var e,v}),t,null,[[6,13]])})))}function $t(){var t=new URL("id",wt.trackingUrl);return xt.isHttp()?t.protocol="http:":t.protocol="https:",t}var zt=function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"1",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"sensic-sdk-web";return Xt(this,void 0,void 0,e().mark((function s(){var u,c;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={version:o,source:a,id:Object.assign({},t),privacy:{providedOptin:n},tracking:r},e.prev=1,e.next=4,Yt();case 4:u.privacy.tcString=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),l.warn("Could not determine TC string: "+e.t0);case 10:if(!r||!i){e.next=17;break}return e.t1=Object,e.t2=u.id,e.next=15,Qt();case 15:e.t3=e.sent,e.t1.assign.call(e.t1,e.t2,e.t3);case 17:return l.log("VMS privacy settings:, ".concat(JSON.stringify(u,null,2))),c=$t(),e.next=21,Ot.sendData(c.href,"POST",u);case 21:case"end":return e.stop()}}),s,null,[[1,7]])})))},Jt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function Zt(t){return Jt(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=te(t),ee(t,r),l.log("Relay ID: "+r),e.next=6,Ot.sendData(r.href+"&redirect=manual","GET",null,(function(t){if(window.top.postMessage({relayRequestServerDate:t.getResponseHeader("Date")},"*"),t.getAllResponseHeaders().includes("x-location")){var e=new XMLHttpRequest;e.open("GET",t.getResponseHeader("x-location"),!0),e.send()}}));case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0),l.error("Failed to send relay request: "+e.t0.message);case 12:case"end":return e.stop()}}),n,null,[[0,9]])})))}function te(t){var e=xt.isHttp()?"http://":"https://",n=(t||"error-got-empty-id").replace("|","-")+wt.suiPixelUrl;return new URL(e+n)}function ee(t,e){var n,r=e.searchParams,i=new URLSearchParams(window.location.search);(null===(n=window.gfkS2sConf)||void 0===n?void 0:n.media)&&r.append("m",window.gfkS2sConf.media);for(var o=0,a=["r","m","paneluserid","hhid","uid","pid","origin"];o<a.length;o++){var s=a[o];i.has(s)&&r.append(s,i.get(s))}r.append("r",window.location.host),r.append("p",wt.projectId),r.append("instanceid",t)}var ne,re=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ie=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},oe=new(function(){function t(){r(this,t),this.instanceID=kt()}return s(t,[{key:"init",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;return re(this,void 0,void 0,e().mark((function o(){var a,s;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("Using VMS V2"),Zt(this.instanceID),e.next=4,this.hasOldPanelCookie();case 4:a=e.sent,s={instanceid:this.instanceID},(r.paneluserid||r.hhid)&&(s.panelistid={panel:r.pid,paneluserid:r.paneluserid,panelhouseholdid:r.hhid,panelhouseholdmemberid:r.uid}),Et({optin:t},a).then((function(e){var o;zt(s,null!==(o=r.optin)&&void 0!==o?o:t,e,!0,"2",i).then((function(){"function"==typeof n&&n()}))}));case 8:case"end":return e.stop()}}),o,this)})))}},{key:"hasOldPanelCookie",value:function(){return re(this,void 0,void 0,e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Wt();case 3:return n=t.sent,t.abrupt("return",void 0!==(null==n?void 0:n.paneluserid)||void 0!==(null==n?void 0:n.uid)||void 0!==(null==n?void 0:n.hhid)||void 0!==(null==n?void 0:n.pid));case 7:t.prev=7,t.t0=t.catch(0),l.error("Failed to get oldPanelCookie: "+t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))}}]),t}());l.readFromTagConf(),l.readFromLocalStorage(),Array.prototype.forEach&&Array.prototype.indexOf&&window.JSON?(ne=(new Date).getTime(),window.s2sSdkConfig=new i,d.setConfig(window.s2sSdkConfig),d.init(window.gfkS2sConf,oe),function(){var t,n;ie(this,void 0,void 0,e().mark((function r(){var i;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.gfks?window.gfks=bt:(l.output("You are using a deprecated tag. Please visit https://confluence-docu.gfk.com/display/SENSIC/Adding+the+Tag and update your tag.","warn"),window.s=bt),(null===(t=window.gfkS2s)||void 0===t?void 0:t.agents)&&window.gfkS2s.agents.forEach((function(t){var e=t.a;t.a=new bt(e.config,e.pId,(function(){return e.p}),window.s2sSdkConfig),l.output('Processing started for player "'+e.pId+'"',"info"),e.queue.forEach((function(n){l.output('Method "'+n.f+'" was executed for player "'+e.pId+'" before SDK loaded',"info"),t.a[n.f].apply(t.a,n.a)})),t.a.setStreamPositionCallback(e.cb)})),(null===(n=window.gfkS2s)||void 0===n?void 0:n.onSdkLoaded)&&window.gfkS2s.onSdkLoaded(),i=(new Date).getTime()-ne,l.output("Agents initialized after ".concat(i," ms"),"debug"),window.gfkS2s&&(window.gfkS2s.getInstanceID=function(){return oe.instanceID});case 6:case"end":return e.stop()}}),r)})))}(),d.setTimeOffset()):l.output("Device doesn't support ECMAScript 5","error")}()}();